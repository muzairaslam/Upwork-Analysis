---
title: "First R User Meet Up (Karachi)"
author: "Uzair Aslam"
echo: true
format: revealjs
incremental: true
editor: visual
---

# Introductions

## Tell us about:

- Your Name
- Your Industry
- Used R before ?

## Why are you here ?

- I am student and wants to learn R.
- I work in Industry and wants to learn Business Data Analysis.
- I am in Academia and wants to see how R can be used in Research.
- Just for Fun!

## Karachi R User Group is for you!

- Part of 92 Groups world wide with 79,564 members
- Networking Opportunity with your industry professionals
- Learn about recent developments in R Ecosystem
- Become a Speaker!
- Give back to community

## We are the 37th Country to host R Group 

![](r-user-group-in-pakistan.png)

## My Introduction

# Data Analysis of Upwork Market

Give Overview...

# Overview

## Loading Packages

```{r}
library(tidyverse)
library(scales)
library(gt)
library(here)
library(plotly)
library(janitor)
```

## Load the raw data

```{r}
data <- (read_csv(here("data/data.csv")))
dim(data)
```

## Selecting Coloumns 

```{r}
# select columns for analysis
data_selected <- data |>
  clean_names() |>
  select(search_keyword,
         category_1,
         payment_situation,
         client_country,
         payment_type,
         job_cost,
         start_rate,
         end_rate)
```

::: {.incremental}

## View of Data Set

```{r}
head(data_selected) |>
  gt()
```

```{r}
dim(data_selected)
```
:::

# Data cleaning

## Data Types Correction and Filtering

```{r}
#| output-location: fragment

# correct data types
data_selected$search_keyword <- factor(data_selected$search_keyword)

# remove fixed price jobs where NAs are there
# keep fixed prices projects with max client budget of $5000 
# remove hourly contracts where end rate is not given by the client 
data_cleaned <- data_selected |>
  filter((!is.na(job_cost) & job_cost < 5000) | !is.na(end_rate))

dim(data_cleaned)
```
```{r}
data_remains <- (nrow(data_cleaned)/nrow(data_selected)) * 100
print(data_remains)
```

# Exploratory Data Analysis (EDA)

## Distribution of Fixed Cost Projects
```{r, warning=FALSE}
#| output-location: slide

p <- ggplot(data_cleaned, aes(x = search_keyword, y = job_cost, fill = search_keyword)) +
  geom_boxplot(size = 1,
               outlier.shape = 1,
               outlier.color = "black",
               outlier.size  = 3) +
  scale_y_continuous(label = dollar) +
  labs(title = "Fixed Project Cost by Keyword Search", 
       subtitle = "Developers Seize High-Value Project Opportunities",
       x = "",
       y = "") +
  theme_minimal() +
  theme(legend.position = "none") +
  coord_flip()

ggplotly(p) 
```


## Fixed Price Vs Hourly Jobs
```{r}
#| output-location: slide

# calculate median of fixed price job for each keyword
median_project_prices_keyword <- data_cleaned |>
  group_by(search_keyword) |>
  summarize(fixed_price_project_value = median(job_cost, na.rm = TRUE),
            hourly_start_rate = median(start_rate, na.rm = TRUE),
            hourly_end_rate = median(end_rate, na.rm = TRUE),
            mid_range =  (hourly_start_rate + hourly_end_rate)/2,
            fixed_price_project = sum(payment_type == "Fixed-price"),
            fixed_price_earnings = fixed_price_project * fixed_price_project_value,
            hourly_projects = sum(payment_type == "Hourly"),
            hourly_project_earnings = hourly_projects * mid_range,
            total_projects = n()) |>
  arrange(desc(fixed_price_project_value)) |>
  gt() |>
  tab_header(
    title = md("**Median One Time Projects / Hourly Contracts**"),
  ) |>
  fmt_number(columns = c(fixed_price_project_value, hourly_start_rate, hourly_end_rate, mid_range,hourly_project_earnings, fixed_price_earnings), decimals = 1) |>
  tab_spanner(
  label = "Fixed",
  columns = c(fixed_price_project_value, fixed_price_project, fixed_price_earnings)
  ) |>
  tab_spanner(
  label = "Hourly",
  columns = c(hourly_start_rate, hourly_end_rate, mid_range, hourly_projects, hourly_project_earnings)
  ) |>
  cols_label(
    search_keyword = "Keyword",
    fixed_price_project_value = "Cost",
    hourly_start_rate = "Start Rate",
    hourly_end_rate = "End Rate",
    fixed_price_project = "Sample size",
    hourly_projects = "Sample size",
    total_projects = "Total sample",
    hourly_project_earnings = "Earnings ($)",
    mid_range = "Mid Rate",
    fixed_price_earnings = "Earnings ($)"
  )
  
median_project_prices_keyword
```

## Insights for Freelancers

- Data Science Projects on average gets $100 (n = 1578)
- Development Projects on average gets $150 (n = 11468)
- Marketing Projects on average gets $150 (n = 6017)		
- Data Science professionals should focus for Hourly Contracts or come outside of Upwork.


## Upwork Client's Top Developer categories?

```{r}
#| output-location: slide

bar_cat_1_dev <- data_cleaned |>
  filter(search_keyword == "Developer") |>
  group_by(search_keyword,category_1) |>
  summarise(count = n()) |>
  mutate(freq = formattable::percent(count / sum(count))) |>
  arrange(desc(count)) |>
  top_n(n = 10) |>
  ggplot(aes(x = reorder(category_1, freq), y = freq, fill = category_1)) +
  geom_bar(stat = "identity") +
  scale_colour_viridis_b(alpha = 0.8) +
  geom_text(aes(label = paste0(freq)), position = position_stack(vjust = 1.05), size = 3.5)  + 
  coord_flip() +
  scale_y_continuous(labels = scales::percent,
                     breaks = scales::breaks_pretty(n = 8)) +
  theme_minimal() +
  labs(title = "") +
  xlab("Skills") +
  ylab("Percentage of responses")

bar_cat_1_dev
```


##  Upwork Client's Top Marketing categories?

```{r}
#| output-location: slide

bar_cat_1_mkg <- data_cleaned |>
  filter(search_keyword == "Marketing") |>
  group_by(search_keyword,category_1) |>
  summarise(count = n()) |>
  mutate(freq = formattable::percent(count / sum(count))) |>
  arrange(desc(count)) |>
  top_n(n = 10) |>
  ggplot(aes(x = reorder(category_1, freq), y = freq, fill = category_1)) +
  geom_bar(stat = "identity") +
  scale_colour_viridis_d(alpha = 0.8) +
  geom_text(aes(label = paste0(freq)), position = position_stack(vjust = 1.05), size = 3.5)  + 
  coord_flip() +
  scale_y_continuous(labels = scales::percent,
                     breaks = scales::breaks_pretty(n = 8)) +
  theme_minimal() +
  labs(title = "") +
  xlab("Skills") +
  ylab("Percentage of responses")

bar_cat_1_mkg
```

## Upwork Client's Top Data Science categories?

```{r}
#| output-location: slide

bar_cat_1_data_science <- data_cleaned |>
  filter(search_keyword == "Data_science") |>
  group_by(search_keyword,category_1) |>
  summarise(count = n()) |>
  mutate(freq = formattable::percent(count / sum(count))) |>
  arrange(desc(count)) |>
  top_n(n = 10) |>
  ggplot(aes(x = reorder(category_1, freq), y = freq, fill = category_1)) +
  geom_bar(stat = "identity") +
  scale_colour_viridis_d(alpha = 0.8) +
  geom_text(aes(label = paste0(freq)), position = position_stack(vjust = 1.05), size = 3.5)  + 
  coord_flip() +
  scale_y_continuous(labels = scales::percent,
                     breaks = scales::breaks_pretty(n = 8)) +
  theme_minimal() +
  labs(title = "") +
  xlab("Skills") +
  ylab("Percentage of responses")

bar_cat_1_data_science
```


## Which region clients pay higher for all Jobs? 

```{r, warning=FALSE}
#| output-location: slide

data_cleaned |>
  group_by(client_country) |>
  summarise(average_pay = median(start_rate, na.rm = TRUE)) |>
  arrange(desc(average_pay)) |>
  top_n(n = 10) |>
  gt()
```


# Questions & Comments ?


## Announcements

- We need a venue to physically host these meetups.

- The venue should be in Karachi.

- It must have a projector

- It can be a company, institute or someone's place 

- Any ideas for Physical Meetup Location ?


## Join the Army


Links of Presentation and R User Group






